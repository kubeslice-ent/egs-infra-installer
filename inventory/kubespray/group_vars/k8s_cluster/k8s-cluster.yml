---
###############################################################################
# KUBESPRAY K8S CLUSTER CONFIGURATION - DYNAMICALLY GENERATED FROM user_input.yml
# This file is automatically generated by setup_kubernetes.sh
# Location: group_vars/k8s_cluster/k8s-cluster.yml
###############################################################################

# Basic cluster configuration
cluster_name: cluster.local

# Kubernetes version (without leading 'v' as required by Kubespray)
kube_version: 1.32.5

# Container runtime
container_manager: containerd

# Network plugin
kube_network_plugin: calico

# Service and pod subnets
kube_service_addresses: 10.233.0.0/18
kube_pods_subnet: 10.233.64.0/18
kube_network_node_prefix: 24

# DNS configuration
dns_mode: coredns
dns_domain: "cluster.local"

# Load balancer configuration

loadbalancer_apiserver_localhost: true
loadbalancer_apiserver_type: haproxy
loadbalancer_apiserver_port: 6444


# API Server configuration
kube_apiserver_bind_address: "0.0.0.0"
kube_apiserver_port: 6444

###############################################################################
# CERTIFICATE CONFIGURATION - CRITICAL FOR FIXING CERTIFICATE ERRORS
###############################################################################

## Supplementary addresses that can be added in kubernetes ssl keys.
## CRITICAL: Adding 0.0.0.0 fixes "x509: certificate is valid for ... not 0.0.0.0" error
## This list includes all possible connection addresses for the API server
supplementary_addresses_in_ssl_keys:
  - "0.0.0.0"          # Any interface - FIXES THE CERTIFICATE ERROR!
  - "127.0.0.1"        # Localhost
  - "localhost"        # Hostname

  - "172.105.60.77"  # Control plane node 1






###############################################################################
# SECURITY CONFIGURATION
###############################################################################

# RBAC
rbac_enabled: true

# TLS configuration
tls_min_version: "VersionTLS12"

# API server security
kube_encrypt_secret_data: false
kube_api_anonymous_auth: true

# Audit configuration
kubernetes_audit: false

###############################################################################
# NODE CONFIGURATION
###############################################################################

# Kubelet configuration
kubelet_max_pods: 256
kube_read_only_port: 0

# Node allocatable enforcement
kubelet_enforce_node_allocatable: "pods"

###############################################################################
# NVIDIA GPU SUPPORT
###############################################################################


# NVIDIA GPU acceleration
nvidia_accelerator_enabled: true
nvidia_driver_install_container: true
nvidia_container_runtime_package_architecture: amd64





nvidia_gpu_flavor: gtx


###############################################################################
# STORAGE CONFIGURATION
###############################################################################

# Persistent volumes
persistent_volumes_enabled: false
volume_cross_zone_attachment: false

###############################################################################
# ETCD CONFIGURATION
###############################################################################


# etcd HA disabled - single node etcd
etcd_deployment_type: kubeadm
etcd_events_cluster_setup: false
etcd_events_cluster_enabled: false


###############################################################################
# ADDON CONFIGURATION
###############################################################################

# Core addons (disabled by default - managed separately)
ingress_nginx_enabled: false
metallb_enabled: false
dashboard_enabled: false

# Networking addons
deploy_netchecker: false

###############################################################################
# ADVANCED CONFIGURATION
###############################################################################

# Certificate auto-renewal
auto_renew_certificates: false

# Remove anonymous access
remove_anonymous_access: false

# Image pull policy
k8s_image_pull_policy: IfNotPresent

# Event retention
event_ttl_duration: "1h0m0s"

# Container runtime acceleration


###############################################################################
# CUSTOM CONFIGURATION
###############################################################################

 